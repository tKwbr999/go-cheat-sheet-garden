---
title: "関数: 可変長引数 (...) の定義"
tags: ["functions", "func", "引数", "パラメータ", "可変長引数", "...", "スライス"]
---

関数の引数の個数を、呼び出し時に柔軟に変えたい場合があります。例えば、任意の個数の数値を合計する関数や、複数のメッセージをまとめて表示する関数などです。Go言語では、**可変長引数 (Variadic Arguments)** という機能を使ってこれを実現できます。

## 可変長引数とは？

可変長引数を使うと、関数を定義する際に、特定の型の引数を**0個以上、任意の個数**受け取れるように指定できます。

## 可変長引数の定義方法: `...型`

関数定義の**最後の引数**の型の前に `...` を付けることで、その引数を可変長引数として宣言します。

**構文:**
```go
func 関数名(固定引数1 型1, ..., 可変長引数名 ...型) 戻り値の型 { ... }
```

*   可変長引数は、必ず**引数リストの最後**に一つだけ指定できます。
*   `...型` (例: `...int`, `...string`) のように、`...` の後に受け取りたい引数の型を指定します。

## 関数内部での扱い: スライス

関数の中で、可変長引数として渡された値は、その型（`...` の後の型）の**スライス (Slice)** として扱われます。スライスは、複数の要素を格納できる可変長の配列のようなものです（詳細はデータ構造のセクションで学びます）。

```go title="可変長引数関数の定義例"
package main

import "fmt"

// 任意の個数の int 型引数を受け取り、その合計を返す関数
// nums は関数内で []int (int のスライス) として扱われる
func sum(nums ...int) int {
	fmt.Printf("sum 関数に渡された引数 (nums): %v (型: %T)\n", nums, nums)

	total := 0
	// スライスなので for range で各要素にアクセスできる
	for _, num := range nums {
		total += num
	}
	return total
}

// 任意の個数の string 型引数を受け取り、それらを連結して表示する関数
// messages は関数内で []string (string のスライス) として扱われる
func printMessages(messages ...string) {
	fmt.Println("--- メッセージ一覧 ---")
	if len(messages) == 0 {
		fmt.Println("(メッセージはありません)")
		return
	}
	for i, msg := range messages {
		fmt.Printf("%d: %s\n", i+1, msg)
	}
	fmt.Println("--------------------")
}

func main() {
	// sum 関数を呼び出す (呼び出し方は次のセクションで)
	total1 := sum(1, 2, 3)       // 引数 3つ
	total2 := sum(10, 20)        // 引数 2つ
	total3 := sum()              // 引数 0個
	total4 := sum(5, -1, 4, 10) // 引数 4つ

	fmt.Printf("sum(1, 2, 3) = %d\n", total1)
	fmt.Printf("sum(10, 20) = %d\n", total2)
	fmt.Printf("sum() = %d\n", total3)
	fmt.Printf("sum(5, -1, 4, 10) = %d\n", total4)

	fmt.Println()

	// printMessages 関数を呼び出す
	printMessages("おはよう", "こんにちは", "こんばんは")
	printMessages("エラー発生")
	printMessages() // 引数なしでも呼び出せる
}

/* 実行結果:
sum 関数に渡された引数 (nums): [1 2 3] (型: []int)
sum 関数に渡された引数 (nums): [10 20] (型: []int)
sum 関数に渡された引数 (nums): [] (型: []int)
sum 関数に渡された引数 (nums): [5 -1 4 10] (型: []int)
sum(1, 2, 3) = 6
sum(10, 20) = 30
sum() = 0
sum(5, -1, 4, 10) = 18

--- メッセージ一覧 ---
1: おはよう
2: こんにちは
3: こんばんは
--------------------
--- メッセージ一覧 ---
1: エラー発生
--------------------
--- メッセージ一覧 ---
(メッセージはありません)
--------------------
*/
```

**コード解説:**

*   `func sum(nums ...int)`: `int` 型の引数を0個以上受け取る関数 `sum` を定義しています。関数内では `nums` は `[]int` 型のスライスとして扱われます。
*   `func printMessages(messages ...string)`: `string` 型の引数を0個以上受け取る関数 `printMessages` を定義しています。関数内では `messages` は `[]string` 型のスライスとして扱われます。
*   関数内で `nums` や `messages` がスライスとして扱われていることは、`fmt.Printf` の `%T` による型表示や、`len()` 関数、`for range` ループを使っていることから確認できます。
*   `main` 関数での呼び出しを見ると、`sum` や `printMessages` に様々な個数の引数を渡せていることがわかります。引数を渡さない呼び出し (`sum()`, `printMessages()`) も可能です。

可変長引数を使うことで、`fmt.Println` のように任意の数の引数を取れる柔軟な関数を定義することができます。次のセクションでは、可変長引数を持つ関数の呼び出し方について詳しく見ていきます。