---
title: "制御構文: `if` 文と短い初期化ステートメント"
tags: ["flow-control", "if", "初期化ステートメント", "スコープ"]
---

Goの `if` 文には、条件式を評価する直前に**短いステートメント**（通常は変数の宣言と初期化）を実行できる便利な構文があります。

## 構文: `if 初期化ステートメント; 条件式 { ... }`

```go title="if 文と初期化ステートメント"
package main

import (
	"fmt"
	"math/rand"
	"time"
)

// ダミー関数: ランダムな数値を返す
func getRandomValue() int {
	// Go 1.20 以降の推奨される乱数生成方法
	// Go 1.20 より前は rand.Seed(time.Now().UnixNano()) が必要
	return rand.Intn(20) // 0から19までのランダムな整数
}

func main() {
	// if 文の中で変数を宣言・初期化し、その値を条件式で使う
	// 構文: if 初期化ステートメント; 条件式 { ... }
	if value := getRandomValue(); value > 10 {
		// value はこの if-else if-else ブロック内でのみ有効 (スコープが限定される)
		fmt.Printf("生成された値 %d は 10 より大きいです。\n", value)
	} else if value > 5 {
		fmt.Printf("生成された値 %d は 5 より大きく、10 以下です。\n", value)
	} else {
		fmt.Printf("生成された値 %d は 5 以下です。\n", value)
	}

	// fmt.Println(value) // エラー: value は if ブロックの外では未定義 (undefined: value)
}

/* 実行結果 (実行ごとに変わります):
生成された値 7 は 5 より大きく、10 以下です。 (例)
*/
/* 実行結果 (別の例):
生成された値 15 は 10 より大きいです。 (例)
*/
/* 実行結果 (別の例):
生成された値 3 は 5 以下です。 (例)
*/
```

**コード解説:**

*   `if value := getRandomValue(); value > 10 { ... }`:
    *   `value := getRandomValue()`: これが**初期化ステートメント**です。`if` 文の条件を評価する**前**に実行されます。ここでは、`getRandomValue()` 関数を呼び出し、その戻り値で新しい変数 `value` を宣言・初期化しています。
    *   `;`: 初期化ステートメントと条件式を区切るセミコロンです。
    *   `value > 10`: これが**条件式**です。初期化ステートメントで宣言された変数 `value` を使って条件を評価します。
*   **スコープ:** この構文で宣言された変数 (`value`) は、その `if` 文（および関連する `else if`, `else` ブロック）の**内部でのみ有効**です。`if` ブロックの外側から `value` にアクセスしようとするとコンパイルエラーになります。

## なぜこの構文を使うのか？

1.  **変数のスコープを限定できる:** 条件判断のためだけに一時的に必要な変数を、`if` 文の外部に漏らさないようにできます。これにより、変数の影響範囲が明確になり、コードが読みやすく、保守しやすくなります。
2.  **コードが簡潔になる:** 変数の宣言と条件判断を一行で書けるため、コードが短くなります。

この構文は、特に関数を呼び出してその結果をすぐに条件判断に使いたい場合（例えば、エラーチェックなど）に非常によく使われます。次のセクションでエラーチェックの例を見てみましょう。