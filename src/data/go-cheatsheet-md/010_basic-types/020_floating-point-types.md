---
title: "基本の型: 浮動小数点数 (Floating-Point)"
tags: ["basic-types", "浮動小数点数", "float32", "float64", "精度"]
---

整数だけでなく、円周率 (3.14159...) や、割合 (0.5) のような**小数点を含む数値**を扱いたい場合も多くあります。このような数値を表現するために使われるのが**浮動小数点数 (Floating-Point Number)** 型です。

## 浮動小数点数型とは？

浮動小数点数は、非常に大きな数や非常に小さな数、そして小数点以下の数値を表現するための形式です。名前の「浮動」は、小数点の位置を固定せず、指数部を使って表現することで、広い範囲の数値を扱えることに由来します。

Go言語には、標準的な **IEEE 754** 規格に基づいた2種類の浮動小数点数型があります。

## Goの浮動小数点数型: `float32` と `float64`

*   **`float32`**: 32ビット（単精度）浮動小数点数。表現できる数値の範囲や精度は `float64` よりも小さいですが、メモリ使用量も半分で済みます。
*   **`float64`**: 64ビット（倍精度）浮動小数点数。`float32` よりも広い範囲の数値を、より高い精度で表現できます。Go言語では、**小数点を含む数値リテラル（例: `3.14`, `1.0`）は、デフォルトで `float64` 型**として扱われます。特別な理由がない限り、浮動小数点数には `float64` を使うのが一般的です。

```go title="浮動小数点数型の宣言と演算例"
package main

import (
	"fmt"
	"math" // float32, float64 の最大値などを含む
)

func main() {
	// float64 型 (デフォルト)
	var pi float64 = 3.141592653589793
	radius := 5.0 // 型推論により float64 になる
	area := pi * radius * radius

	fmt.Printf("円周率 (float64): %.15f\n", pi) // %.15f で小数点以下15桁表示
	fmt.Printf("半径 (float64): %.1f\n", radius)
	fmt.Printf("面積 (float64): %.5f\n", area)
	fmt.Printf("float64 の最大値: %e\n", math.MaxFloat64) // %e は指数表記

	fmt.Println() // 空行

	// float32 型
	var gravity float32 = 9.80665
	mass := float32(10.0) // float32 型に変換
	force := mass * gravity

	fmt.Printf("重力加速度 (float32): %.5f\n", gravity)
	fmt.Printf("質量 (float32): %.1f\n", mass)
	fmt.Printf("力 (float32): %.3f\n", force)
	fmt.Printf("float32 の最大値: %e\n", math.MaxFloat32)

	// 浮動小数点数計算の注意点: 誤差
	// 0.1 + 0.2 は正確に 0.3 にならないことがある
	sum := 0.1 + 0.2
	fmt.Printf("\n0.1 + 0.2 = %.17f\n", sum) // 内部表現に近い値を出力
	fmt.Printf("0.1 + 0.2 == 0.3 は %t\n", sum == 0.3) // false になる可能性がある
}

/* 実行結果 (環境によって微妙な誤差はありえます):
円周率 (float64): 3.141592653589793
半径 (float64): 5.0
面積 (float64): 78.53982
float64 の最大値: 1.797693e+308

重力加速度 (float32): 9.80665
質量 (float32): 10.0
力 (float32): 98.067
float32 の最大値: 3.402823e+38

0.1 + 0.2 = 0.30000000000000004
0.1 + 0.2 == 0.3 は false
*/
```

**コード解説:**

*   `float64` と `float32` を使って変数を宣言しています。`radius := 5.0` のように型を省略すると `float64` になります。
*   `float32(10.0)` のように、型名を関数のように使って明示的に型変換（キャスト）することができます。
*   `fmt.Printf` の `%f` は浮動小数点数を表示するための書式指定子です。`.` の後に数字を付けると表示する小数点以下の桁数を指定できます (`%.15f`, `%.1f` など)。`%e` は指数表記（科学的表記法）で表示します。
*   **重要な注意点:** 浮動小数点数は、コンピュータ内部では2進数で近似的に表現されるため、`0.1` のような10進数でキリの良い小数でも、2進数では無限小数となり、**誤差**が生じることがあります。そのため、`0.1 + 0.2` が正確に `0.3` になるとは限らず、浮動小数点数同士を `==` で比較するのは一般的に避けるべきです。比較する際は、差の絶対値が非常に小さい値（イプシロン）以下であるかを確認するなどの方法を取ります。

**どちらを使うべきか？**

*   **`float64`**: ほとんどの場合、こちらを使用します。精度が高く、Goのデフォルトでもあるため、互換性の問題も起きにくいです。
*   **`float32`**: メモリ使用量を節約したい場合（大量の数値を扱うグラフィックス処理など）や、外部システムが `float32` を要求する場合などに限定的に使用します。

浮動小数点数は科学技術計算やグラフィックスなどで広く使われますが、その特性（特に誤差）を理解しておくことが重要です。