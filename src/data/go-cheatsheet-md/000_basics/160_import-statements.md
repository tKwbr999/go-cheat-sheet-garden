---
title: "パッケージのインポート `import`: 他のコードを利用する"
tags: ["basics", "パッケージ", "import", "エイリアス", "ドットインポート", "ブランクインポート"]
---

Goのプログラムは、多くの場合、標準ライブラリや他の開発者が作成したパッケージ（サードパーティパッケージ）、あるいは自分自身が作成した別のパッケージの機能を利用します。これらの外部パッケージの機能を使うためには、`import` 文を使ってプログラムに「取り込む」必要があります。

## `import` の基本

`import` 文は通常、ファイルの先頭、`package` 宣言の直後に記述します。

```go title="単一パッケージのインポート"
package main

import "fmt" // 標準ライブラリの fmt パッケージをインポート

func main() {
	// インポートした fmt パッケージの Println 関数を利用
	fmt.Println("fmt パッケージをインポートしました。")
}
```

*   `import "パッケージパス"` の形式で、利用したいパッケージのパスをダブルクォート `"` で囲んで指定します。
*   `"fmt"` はGoの標準ライブラリに含まれるパッケージの一つです。

## 複数のパッケージをインポート `import()`

複数のパッケージを利用したい場合は、`import` キーワードの後に括弧 `()` を続け、その中にインポートしたいパッケージパスを一行ずつ記述します。これは「ファクタリングされたインポート」と呼ばれ、Goでは一般的な書き方です。

```go title="複数パッケージのインポート"
package main

import (
	// 標準ライブラリのパッケージ
	"fmt"
	"math/rand" // 乱数を生成するパッケージ
	"strings"   // 文字列操作のパッケージ
	"time"      // 時間関連のパッケージ

	// サードパーティパッケージ (例: go get で取得したもの)
	// "github.com/google/uuid"

	// 自分のプロジェクト内の他のパッケージ (例)
	// "myproject/myutils"
)

func main() {
	// インポートしたパッケージの機能を利用
	fmt.Println("複数のパッケージをインポートしました。")

	// strings パッケージの機能
	message := "hello world"
	upperMessage := strings.ToUpper(message)
	fmt.Println("大文字に変換:", upperMessage)

	// time パッケージの機能
	now := time.Now()
	fmt.Println("現在時刻:", now.Format("2006-01-02 15:04:05")) // Go 独自のフォーマット指定

	// math/rand パッケージの機能 (Go 1.20 以降の推奨)
	// Go 1.20 より前は rand.Seed(time.Now().UnixNano()) が必要でした
	randomNumber := rand.Intn(100) // 0から99までのランダムな整数を生成
	fmt.Println("ランダムな数値:", randomNumber)
}

/* 実行結果 (時刻と乱数は実行ごとに変わります):
複数のパッケージをインポートしました。
大文字に変換: HELLO WORLD
現在時刻: 2023-10-27 10:30:00 (例)
ランダムな数値: 42 (例)
*/
```

**ポイント:**

*   `import()` ブロック内では、パッケージパスを改行で区切って列挙します。
*   慣習として、標準ライブラリのパッケージ、サードパーティのパッケージ、プロジェクト内のローカルパッケージを空行で区切ってグループ化することが推奨されます。これにより、どの種類のパッケージをインポートしているかが分かりやすくなります。
*   インポートしたパッケージの機能は `パッケージ名.識別子`（例: `strings.ToUpper`, `time.Now`）のようにして利用します。パッケージ名は通常、インポートパスの最後の要素と同じになります（例: `"math/rand"` なら `rand`）。

## インポートの応用

### 1. エイリアス (別名)

パッケージ名が長かったり、他のパッケージと名前が衝突したりする場合、インポート時に別名（エイリアス）を付けることができます。

```go
import (
	"fmt"
	myfmt "mylib/customfmt" // customfmt パッケージを myfmt という名前で使う
)

func main() {
	fmt.Println("標準の fmt")
	myfmt.Println("カスタムの myfmt") // エイリアス名で呼び出す
}
```

### 2. ドットインポート (`.`)

パッケージ名のプレフィックスなしで、そのパッケージの要素を直接呼び出せるようにするインポート方法です。

```go
import (
	"fmt"
	. "strings" // strings パッケージの関数を直接呼び出せるようにする
)

func main() {
	// ToUpper を strings.ToUpper と書かずに直接呼び出せる
	fmt.Println(ToUpper("hello"))
}
```

**注意:** ドットインポートは、どのパッケージの関数を呼び出しているのか分かりにくくなるため、コードの可読性を損なう可能性があります。通常は**非推奨**とされ、テストコードなど限定的な場面でのみ使われます。

### 3. ブランクインポート (`_`)

パッケージの関数などを直接使うわけではないが、そのパッケージをインポートすること自体に意味がある場合（パッケージの初期化処理 `init` 関数を実行させたい場合など）に使います。

```go
import (
	"database/sql"
	_ "github.com/go-sql-driver/mysql" // MySQL ドライバを登録する。直接 mysql パッケージの関数は使わない
)

func main() {
	// sql.Open("mysql", ...) のようにして、登録されたドライバを利用する
}
```

`_` でインポートされたパッケージは、そのパッケージ内の `init` 関数が実行されますが、パッケージ名を使ってその中の要素にアクセスすることはできません。

## 未使用インポートエラー

Goでは、インポートしたにも関わらず、そのパッケージの要素をプログラム中で一切使用していない場合、コンパイルエラーになります。これは、不要な依存関係をなくし、コードをクリーンに保つためのルールです。

```go
import (
	"fmt"
	"os" // os パッケージをインポートしたが、使っていない
)

func main() {
	fmt.Println("Hello")
	// os パッケージの機能を使っていないため、コンパイルエラーになる
	// Error: imported and not used: "os"
}
```

`import` 文は、Goのパッケージシステムを活用するための基本であり、コードの再利用性とモジュール性を高める上で不可欠な機能です。